[2023-11-03T14:01:12.769+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: movies-etl-dag.write_to_es scheduled__2023-11-03T13:59:54.887906+00:00 [queued]>
[2023-11-03T14:01:12.778+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: movies-etl-dag.write_to_es scheduled__2023-11-03T13:59:54.887906+00:00 [queued]>
[2023-11-03T14:01:12.778+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 1
[2023-11-03T14:01:12.799+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): write_to_es> on 2023-11-03 13:59:54.887906+00:00
[2023-11-03T14:01:12.806+0000] {standard_task_runner.py:57} INFO - Started process 3613 to run task
[2023-11-03T14:01:12.810+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'movies-etl-dag', 'write_to_es', 'scheduled__2023-11-03T13:59:54.887906+00:00', '--job-id', '170', '--raw', '--subdir', 'DAGS_FOLDER/movie_pg_es.py', '--cfg-path', '/tmp/tmp7uedvw3x']
[2023-11-03T14:01:12.815+0000] {standard_task_runner.py:85} INFO - Job 170: Subtask write_to_es
[2023-11-03T14:01:12.992+0000] {task_command.py:415} INFO - Running <TaskInstance: movies-etl-dag.write_to_es scheduled__2023-11-03T13:59:54.887906+00:00 [running]> on host e468bf2dfd15
[2023-11-03T14:01:13.275+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='movies-etl-dag' AIRFLOW_CTX_TASK_ID='write_to_es' AIRFLOW_CTX_EXECUTION_DATE='2023-11-03T13:59:54.887906+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-11-03T13:59:54.887906+00:00'
[2023-11-03T14:01:13.335+0000] {movie_pg_es.py:144} INFO - [FilmWorkES(id='192b3fc9-97e2-4260-91c6-a9b91a41e520', imdb_rating=5.5, genre=['Comedy'], title='Dickie Roberts: Former Child Star', director=['Sam Weisman'], actors_names=['Scott Terra', 'Craig Bierko', 'Mary McCormack', 'David Spade'], writers_names=['Fred Wolf', 'David Spade'], actors=[{'id': '0d1d24d6-9840-4519-8e7b-dabca3970ae0', 'name': 'Scott Terra'}, {'id': '9052c429-df4d-4088-8ff5-40de76bd74e1', 'name': 'Craig Bierko'}, {'id': 'a02640da-38c3-4796-b1bf-37d7c4d37344', 'name': 'Mary McCormack'}, {'id': 'c358242d-2dd3-4fd4-afa7-dc187854a59b', 'name': 'David Spade'}], writers=[{'id': '6a487623-baa0-4d44-854d-6ca1ca6f8ab4', 'name': 'Fred Wolf'}, {'id': 'c358242d-2dd3-4fd4-afa7-dc187854a59b', 'name': 'David Spade'}], description='Once, he was on top of the world as a popular child actor on TV. Now, he\'s Hollywood\'s punchline about everything wrong with people who were famous as children. All Dickie Roberts wants to do is find that one gig that will restore his honor and everyone\'s love of him, so after learning that Rob Reiner\'s making an ambitious new movie destined to sweep the Oscars, Dickie\'s first in line to audition. He walks out having learned he certainly looks the part but can\'t act it... yet, owing to his very unusual childhood. To research the role, Dickie embarks on a bizarre scheme to live with a suburban family to see how the average American child lives, having them put him up as their "son". But once his gloves are off, Dickie discovers how great it is to be part of a true family, and whether he gets the part or not, his attempt at method acting will certainly change his life forever.'), FilmWorkES(id='9c7dc26a-489d-4c08-9bba-6ae9dc8117f1', imdb_rating=7.0, genre=['Action', 'Animation', 'Sci-Fi'], title='All-Star Superman', director=['Sam Liu'], actors_names=['James Denton', 'Anthony LaPaglia', 'Christina Hendricks', 'Edward Asner'], writers_names=['Joe Shuster', 'Jerry Siegel', 'Grant Morrison', 'Frank Quitely', 'Dwayne McDuffie'], actors=[{'id': '477c81a7-4caf-4ce3-b354-831169a1a068', 'name': 'James Denton'}, {'id': '78e917f3-a80b-4d44-82f4-80712a4160ee', 'name': 'Anthony LaPaglia'}, {'id': 'c05bfb01-60d1-42c7-b372-62bc0a916abf', 'name': 'Christina Hendricks'}, {'id': 'eac1449e-09ed-4912-8467-fba3d489c6bb', 'name': 'Edward Asner'}], writers=[{'id': '1f651d3f-b94a-4bc3-9a7d-68d79848124b', 'name': 'Joe Shuster'}, {'id': '618ed131-f181-4932-b3cb-e637a87d594e', 'name': 'Jerry Siegel'}, {'id': '7754f297-7531-4d31-9ae4-b46100a54982', 'name': 'Grant Morrison'}, {'id': '9b401777-277e-40a2-8e69-cf6561b987ed', 'name': 'Frank Quitely'}, {'id': 'cff61032-be90-44b6-85e2-c0fd6049440c', 'name': 'Dwayne McDuffie'}], description='While saving the crew of the first manned mission to the sun, Superman is poisoned by solar radiation. Dying, he decides to fulfill his lifelong dreams, while still saving the Earth from various threats. But when Lex Luthor reveals his latest plot to control the world, Superman must use his remaining strength to stop him.')]
[2023-11-03T14:01:13.338+0000] {movie_pg_es.py:145} INFO - Processing 2 movie:
[2023-11-03T14:01:13.339+0000] {movie_pg_es.py:154} INFO - [{'_index': 'movies', '_id': '192b3fc9-97e2-4260-91c6-a9b91a41e520', '_source': {'id': '192b3fc9-97e2-4260-91c6-a9b91a41e520', 'imdb_rating': 5.5, 'genre': ['Comedy'], 'title': 'Dickie Roberts: Former Child Star', 'director': ['Sam Weisman'], 'actors_names': ['Scott Terra', 'Craig Bierko', 'Mary McCormack', 'David Spade'], 'writers_names': ['Fred Wolf', 'David Spade'], 'actors': [{'id': '0d1d24d6-9840-4519-8e7b-dabca3970ae0', 'name': 'Scott Terra'}, {'id': '9052c429-df4d-4088-8ff5-40de76bd74e1', 'name': 'Craig Bierko'}, {'id': 'a02640da-38c3-4796-b1bf-37d7c4d37344', 'name': 'Mary McCormack'}, {'id': 'c358242d-2dd3-4fd4-afa7-dc187854a59b', 'name': 'David Spade'}], 'writers': [{'id': '6a487623-baa0-4d44-854d-6ca1ca6f8ab4', 'name': 'Fred Wolf'}, {'id': 'c358242d-2dd3-4fd4-afa7-dc187854a59b', 'name': 'David Spade'}], 'description': 'Once, he was on top of the world as a popular child actor on TV. Now, he\'s Hollywood\'s punchline about everything wrong with people who were famous as children. All Dickie Roberts wants to do is find that one gig that will restore his honor and everyone\'s love of him, so after learning that Rob Reiner\'s making an ambitious new movie destined to sweep the Oscars, Dickie\'s first in line to audition. He walks out having learned he certainly looks the part but can\'t act it... yet, owing to his very unusual childhood. To research the role, Dickie embarks on a bizarre scheme to live with a suburban family to see how the average American child lives, having them put him up as their "son". But once his gloves are off, Dickie discovers how great it is to be part of a true family, and whether he gets the part or not, his attempt at method acting will certainly change his life forever.'}}, {'_index': 'movies', '_id': '9c7dc26a-489d-4c08-9bba-6ae9dc8117f1', '_source': {'id': '9c7dc26a-489d-4c08-9bba-6ae9dc8117f1', 'imdb_rating': 7.0, 'genre': ['Action', 'Animation', 'Sci-Fi'], 'title': 'All-Star Superman', 'director': ['Sam Liu'], 'actors_names': ['James Denton', 'Anthony LaPaglia', 'Christina Hendricks', 'Edward Asner'], 'writers_names': ['Joe Shuster', 'Jerry Siegel', 'Grant Morrison', 'Frank Quitely', 'Dwayne McDuffie'], 'actors': [{'id': '477c81a7-4caf-4ce3-b354-831169a1a068', 'name': 'James Denton'}, {'id': '78e917f3-a80b-4d44-82f4-80712a4160ee', 'name': 'Anthony LaPaglia'}, {'id': 'c05bfb01-60d1-42c7-b372-62bc0a916abf', 'name': 'Christina Hendricks'}, {'id': 'eac1449e-09ed-4912-8467-fba3d489c6bb', 'name': 'Edward Asner'}], 'writers': [{'id': '1f651d3f-b94a-4bc3-9a7d-68d79848124b', 'name': 'Joe Shuster'}, {'id': '618ed131-f181-4932-b3cb-e637a87d594e', 'name': 'Jerry Siegel'}, {'id': '7754f297-7531-4d31-9ae4-b46100a54982', 'name': 'Grant Morrison'}, {'id': '9b401777-277e-40a2-8e69-cf6561b987ed', 'name': 'Frank Quitely'}, {'id': 'cff61032-be90-44b6-85e2-c0fd6049440c', 'name': 'Dwayne McDuffie'}], 'description': 'While saving the crew of the first manned mission to the sun, Superman is poisoned by solar radiation. Dying, he decides to fulfill his lifelong dreams, while still saving the Earth from various threats. But when Lex Luthor reveals his latest plot to control the world, Superman must use his remaining strength to stop him.'}}]
[2023-11-03T14:01:13.483+0000] {_transport.py:336} INFO - PUT http://movies_es_db:9200/_bulk [status:200 duration:0.143s]
[2023-11-03T14:01:13.484+0000] {movie_pg_es.py:156} INFO - Transfer completed, 2 updated
[2023-11-03T14:01:13.484+0000] {python.py:194} INFO - Done. Returned value was: None
[2023-11-03T14:01:13.551+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=movies-etl-dag, task_id=write_to_es, execution_date=20231103T135954, start_date=20231103T140112, end_date=20231103T140113
[2023-11-03T14:01:13.624+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2023-11-03T14:01:13.691+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
